<!doctype html>
<html lang="id">
<head>
  <link rel="stylesheet" href="assets/css/database-generator.css">

  <link rel="stylesheet" href="assets/css/theme.css">

  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Campaign File Generator</title>
  <script src="https://cdn.tailwindcss.com"></script>



  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/7.0.0/css/all.min.css"/>
</head>
<body class="min-h-screen bg-slate-950 text-slate-100">
  <main class="max-w-6xl mx-auto p-6">
    <header class="mb-6">
      <h1 class="text-2xl md:text-3xl font-semibold tracking-tight">Campaign File Generator</h1>
      <p class="text-slate-400 mt-1">
        Masukkan <span class="font-mono">Campaign ID</span> (wajib diawali <strong>YYYYMMDD</strong>, sisanya bebas) & email â†’ generate 4 file .txt:
        <span class="font-mono">CustMast</span>, <span class="font-mono">CustPref</span>, <span class="font-mono">CustSubs</span>, <span class="font-mono">CustAttr</span>.
      </p>
    </header>

    <section class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-4">
      <div class="md:col-span-2">
        <label class="text-sm text-slate-300">Campaign ID</label>
        <input id="campaignId" class="mt-1 w-full rounded-2xl bg-slate-900 border border-slate-700 px-4 py-3 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono" placeholder="YYYYMMDD_nama_bebas" spellcheck="false" />
        <p class="text-xs mt-1 text-slate-400">Contoh: <span class="font-mono">20250817_Independence-Day_1700</span></p>
      </div>
    </section>

    <!-- PANEL: EMAIL + KRHRED (tanpa switch; dynamic jika ada â‰¥1 kolom KRHRED) -->
    <section id="krPanel" class="bg-slate-900/60 border border-slate-800 rounded-2xl p-4 mb-6">
      <div class="flex flex-wrap items-end gap-3 mb-4">
        <div class="flex items-end gap-3 grow">
          <div class="grow">
            <label class="text-sm text-slate-300">Tambah Email</label>
            <input id="newEmail" class="mt-1 w-full rounded-2xl bg-slate-900 border border-slate-700 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500" placeholder="email@contoh.com"/>
          </div>
          <button id="addEmail" class="px-4 py-2 rounded-2xl bg-emerald-600 hover:bg-emerald-500">Tambah email</button>
        </div>
        <div class="flex items-end gap-3">
          <div>
            <label class="text-sm text-slate-300">Tambah kolom KRHRED</label>
            <input id="newKey" class="mt-1 w-56 rounded-2xl bg-slate-900 border border-slate-700 px-4 py-2 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono" placeholder="KRHRED_Unit_30"/>
            <p class="text-[11px] text-slate-400 mt-1">Kosongkan untuk auto: <span class="font-mono">KRHRED_Unit_N</span> berikutnya.</p>
          </div>
          <button id="addKey" class="px-4 py-2 rounded-2xl bg-indigo-600 hover:bg-indigo-500">Tambah kolom</button>
        </div>

        <!-- tombol buka panel bulk -->
        <div>
          <button id="bulkBtn" class="px-4 py-2 rounded-2xl bg-slate-800 hover:bg-slate-700">Tempel banyak email</button>
        </div>
      </div>

      <!-- panel bulk -->
      <div id="bulkBox" class="hidden mb-4">
        <label class="text-sm text-slate-300">Tempel banyak email (pisahkan dengan baris/koma/titik koma/spasi)</label>
        <textarea id="bulkEmails" class="mt-1 w-full rounded-2xl bg-slate-900 border border-slate-700 px-4 py-3 h-28 resize-y focus:outline-none focus:ring-2 focus:ring-indigo-500 font-mono" placeholder="email1@a.com&#10;email2@a.com, email3@a.com; email4@a.com"></textarea>
        <div class="flex gap-3 mt-2">
          <button id="applyBulk" class="px-4 py-2 rounded-2xl bg-emerald-600 hover:bg-emerald-500">Tambahkan</button>
          <button id="cancelBulk" class="px-4 py-2 rounded-2xl bg-slate-800 hover:bg-slate-700">Batal</button>
        </div>
        <p id="bulkInfo" class="text-xs text-slate-400 mt-2"></p>
      </div>

      <div class="text-xs text-slate-400 mb-2 flex items-center gap-3">
        <span id="countInfo">Total: 0</span>
        <span id="invalidInfo" class="hidden text-rose-400"></span>
      </div>

      <div class="overflow-auto">
        <table class="min-w-full text-sm">
          <thead>
            <tr id="krHeadRow">
              <th class="text-left px-3 py-2 sticky left-0 bg-slate-900/80 backdrop-blur border-b border-slate-800">Email</th>
              <!-- dynamic head cells here -->
            </tr>
          </thead>
          <tbody id="krBody"></tbody>
        </table>
      </div>

      <div class="text-xs text-slate-400 mt-3">
        <p>Tips: klik ikon âœ• di header kolom untuk menghapus kolom KRHRED. Klik ðŸ—‘ di baris untuk menghapus email.</p>
      </div>
    </section>

    <div class="flex flex-wrap items-center gap-3 mb-2">
      <button id="btnDownload" class="px-4 py-2 rounded-2xl shadow bg-indigo-600 hover:bg-indigo-500 disabled:opacity-40" disabled>
        Download 4 file
      </button>
      <button id="btnSave" class="px-4 py-2 rounded-2xl shadow bg-emerald-600 hover:bg-emerald-500 disabled:opacity-40" disabled>
        Save to folder
      </button>
      <span id="stateMsg" class="text-xs text-slate-400"></span>
    </div>

    <p id="error" class="text-amber-300 text-sm mb-4 hidden"></p>

    <section id="previews" class="grid grid-cols-1 md:grid-cols-2 gap-4"></section>

    <!-- Fallback links jika auto-download diblok -->
    <section id="dlSection" class="mt-4 hidden">
      <h3 class="text-sm text-slate-300 mb-2">Unduhan manual (fallback)</h3>
      <div id="downloadsList" class="flex flex-col gap-2"></div>
      <p class="text-xs text-slate-400 mt-2">Jika auto-download tidak berjalan, klik link di atas satu per satu.</p>
    </section>

    <footer class="mt-6 text-xs text-slate-400">
      <p>Catatan: "Save to folder" memakai File System Access API (tersedia di Chrome/Edge desktop). Jika tidak didukung, gunakan tombol <em>Download 4 file</em> atau link fallback.</p>
    </footer>
  </main>

  

<!-- Tombol Back ke Index -->
<button class="back-btn" onclick="window.location.href='index.html'"><i class="fa-solid fa-house"></i></button>



<script src="assets/js/database-generator.js" defer></script>
</body>
</html>
